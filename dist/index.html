<html>
    <head>
        <meta charset="UTF-8">
        <script src="pixi.js"></script>
        <script src="nani.js"></script>
    </head>
    <body>
        <canvas id="workspace" width="512" height="512"></canvas>
        <script>
            const workspace = document.getElementById("workspace");
	        const app = new PIXI.Application({view: workspace, width: workspace.width, height: workspace.height});
            
            PIXI.loader.add('legioConfig', 'emitter_circle.json').load(function(loader, resources) {
                const particleSystem = new Nani.ParticleSystem(resources.legioConfig.data);
                const pixiParticleSystem = createPixiParticleSystem(particleSystem);
                pixiParticleSystem.position.set(app.renderer.width * 0.5, app.renderer.height * 0.5);
            });
            
            function createPixiParticleSystem(particleSystem) {
                const pixiParticleSystem = new PIXI.Container();
                for (let emitter of particleSystem._emitters) {
                    pixiParticleSystem.addChild(createPixiEmitter(emitter));
                }
                return app.stage.addChild(pixiParticleSystem);
            }

            function createPixiEmitter(emitter) {
                const pixiEmitter = new PIXI.Container();
                for (let particle of emitter._particles) {
                    pixiEmitter.addChild(createPixiParticle(particle));
                }
                return pixiEmitter;
            }
           
            function createPixiParticle(particle) {
                const pixiParticle = new PIXI.Graphics();
                pixiParticle.beginFill(0xffffff);
                pixiParticle.drawCircle(particle.x, particle.y, 2);
                pixiParticle.endFill();
                return pixiParticle;
            };

        </script>
    </body>
</html>
